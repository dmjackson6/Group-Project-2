<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>User Management - WasteNaut Admin</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../resources/styles/main.css" />
  </head>
  <body>
    <!-- Header Container -->
    <div id="header-container"></div>

    <!-- Main Content -->
    <div class="container py-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="d-flex align-items-center mb-3">
            <div class="bg-primary rounded-circle d-inline-flex align-items-center justify-content-center me-3" style="width: 50px; height: 50px;">
              <i class="bi bi-people text-white fs-5"></i>
            </div>
            <div>
              <h1 class="h3 mb-1 text-gradient">User Management</h1>
              <p class="text-muted mb-0">Manage user accounts and permissions</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Search and Filters -->
      <div class="card border-0 bg-dark mb-4">
        <div class="card-body">
          <div class="row g-3">
            <div class="col-md-4">
              <label for="searchUsers" class="form-label">Search Users</label>
              <input type="text" class="form-control" id="searchUsers" placeholder="Search by name, email, or ID...">
            </div>
            <div class="col-md-3">
              <label for="roleFilter" class="form-label">Role Filter</label>
              <select class="form-select" id="roleFilter">
                <option value="">All Roles</option>
                <option value="individual">Individual Recipient</option>
                <option value="organization">Organization</option>
                <option value="donor">Donor</option>
                <option value="foodbank">Food Bank</option>
                <option value="admin">Admin</option>
              </select>
            </div>
            <div class="col-md-3">
              <label for="statusFilter" class="form-label">Status Filter</label>
              <select class="form-select" id="statusFilter">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="pending">Pending</option>
                <option value="suspended">Suspended</option>
                <option value="banned">Banned</option>
              </select>
            </div>
            <div class="col-md-2">
              <label class="form-label">&nbsp;</label>
              <button class="btn btn-primary w-100" onclick="searchUsers()">
                <i class="bi bi-search me-2"></i>Search
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- User Actions -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="d-flex gap-2">
            <button class="btn btn-success" onclick="showComingSoon('Add User')">
              <i class="bi bi-person-plus me-2"></i>Add User
            </button>
            <button class="btn btn-warning" onclick="showComingSoon('Bulk Actions')">
              <i class="bi bi-gear me-2"></i>Bulk Actions
            </button>
            <button class="btn btn-info" onclick="showComingSoon('Export Users')">
              <i class="bi bi-download me-2"></i>Export
            </button>
            <button class="btn btn-outline-secondary" onclick="showComingSoon('Import Users')">
              <i class="bi bi-upload me-2"></i>Import
            </button>
          </div>
        </div>
      </div>

      <!-- Users Table -->
      <div class="card border-0 bg-dark">
        <div class="card-header bg-dark border-bottom">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="bi bi-list-ul me-2"></i>User Accounts
            </h5>
            <div class="d-flex gap-2">
              <span class="badge bg-primary">Total: 1,247</span>
              <span class="badge bg-success">Active: 1,156</span>
              <span class="badge bg-warning">Pending: 91</span>
            </div>
          </div>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-dark table-hover mb-0">
              <thead>
                <tr>
                  <th>
                    <input type="checkbox" class="form-check-input" id="selectAll">
                  </th>
                  <th>User</th>
                  <th>Role</th>
                  <th>Status</th>
                  <th>Last Active</th>
                  <th>Registration</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="usersTableBody">
                <!-- Sample user data -->
                <tr>
                  <td><input type="checkbox" class="form-check-input" value="1"></td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="bg-primary rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 30px; height: 30px;">
                        <i class="bi bi-person text-white small"></i>
                      </div>
                      <div>
                        <div class="fw-bold">Sarah Johnson</div>
                        <small class="text-muted">sarah.j@email.com</small>
                      </div>
                    </div>
                  </td>
                  <td><span class="badge bg-info">Individual</span></td>
                  <td><span class="badge bg-success">Active</span></td>
                  <td>2 hours ago</td>
                  <td>Jan 15, 2024</td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <button class="btn btn-outline-primary" onclick="editUser(1)">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button class="btn btn-outline-info" onclick="viewUser(1)">
                        <i class="bi bi-eye"></i>
                      </button>
                      <button class="btn btn-outline-warning" onclick="suspendUser(1)">
                        <i class="bi bi-pause"></i>
                      </button>
                      <button class="btn btn-outline-danger" onclick="deleteUser(1)">
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="form-check-input" value="2"></td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="bg-success rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 30px; height: 30px;">
                        <i class="bi bi-building text-white small"></i>
                      </div>
                      <div>
                        <div class="fw-bold">Green Valley Food Bank</div>
                        <small class="text-muted">contact@greenvalley.org</small>
                      </div>
                    </div>
                  </td>
                  <td><span class="badge bg-success">Food Bank</span></td>
                  <td><span class="badge bg-warning">Pending</span></td>
                  <td>Never</td>
                  <td>Jan 20, 2024</td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <button class="btn btn-outline-primary" onclick="editUser(2)">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button class="btn btn-outline-info" onclick="viewUser(2)">
                        <i class="bi bi-eye"></i>
                      </button>
                      <button class="btn btn-outline-success" onclick="approveUser(2)">
                        <i class="bi bi-check"></i>
                      </button>
                      <button class="btn btn-outline-danger" onclick="rejectUser(2)">
                        <i class="bi bi-x"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="form-check-input" value="3"></td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="bg-warning rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 30px; height: 30px;">
                        <i class="bi bi-gift text-white small"></i>
                      </div>
                      <div>
                        <div class="fw-bold">Mike Chen</div>
                        <small class="text-muted">mike.chen@email.com</small>
                      </div>
                    </div>
                  </td>
                  <td><span class="badge bg-warning">Donor</span></td>
                  <td><span class="badge bg-success">Active</span></td>
                  <td>1 day ago</td>
                  <td>Jan 10, 2024</td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <button class="btn btn-outline-primary" onclick="editUser(3)">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button class="btn btn-outline-info" onclick="viewUser(3)">
                        <i class="bi bi-eye"></i>
                      </button>
                      <button class="btn btn-outline-warning" onclick="suspendUser(3)">
                        <i class="bi bi-pause"></i>
                      </button>
                      <button class="btn btn-outline-danger" onclick="deleteUser(3)">
                        <i class="bi bi-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td><input type="checkbox" class="form-check-input" value="4"></td>
                  <td>
                    <div class="d-flex align-items-center">
                      <div class="bg-danger rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 30px; height: 30px;">
                        <i class="bi bi-shield text-white small"></i>
                      </div>
                      <div>
                        <div class="fw-bold">Alex Rodriguez</div>
                        <small class="text-muted">alex.r@email.com</small>
                      </div>
                    </div>
                  </td>
                  <td><span class="badge bg-danger">Admin</span></td>
                  <td><span class="badge bg-success">Active</span></td>
                  <td>30 minutes ago</td>
                  <td>Dec 1, 2023</td>
                  <td>
                    <div class="btn-group btn-group-sm">
                      <button class="btn btn-outline-primary" onclick="editUser(4)">
                        <i class="bi bi-pencil"></i>
                      </button>
                      <button class="btn btn-outline-info" onclick="viewUser(4)">
                        <i class="bi bi-eye"></i>
                      </button>
                      <button class="btn btn-outline-secondary" disabled>
                        <i class="bi bi-lock"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="card-footer bg-dark border-top">
          <div class="d-flex justify-content-between align-items-center">
            <div class="text-muted small">
              Showing 1-4 of 1,247 users
            </div>
            <nav>
              <ul class="pagination pagination-sm mb-0">
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1">Previous</a>
                </li>
                <li class="page-item active">
                  <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">2</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">3</a>
                </li>
                <li class="page-item">
                  <a class="page-link" href="#">Next</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS bundle -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>

    <!-- Custom JS -->
    <script src="../resources/scripts/main.js"></script>
    <script src="../resources/scripts/auth.js"></script>
    <script src="../resources/scripts/header-include.js"></script>
    <script src="../resources/scripts/header.js"></script>
    <script>
      // User management functionality
      document.addEventListener('DOMContentLoaded', function() {
        // Protect this page - only admin users can access
        if (!authManager.protectPage('admin')) {
          return;
        }
        
        loadUsers();
        setupSelectAll();
      });

      function loadUsers() {
        // Load users (in real app, this would come from backend)
        console.log('Loading users...');
      }

      function setupSelectAll() {
        const selectAllCheckbox = document.getElementById('selectAll');
        const userCheckboxes = document.querySelectorAll('tbody input[type="checkbox"]');
        
        selectAllCheckbox.addEventListener('change', function() {
          userCheckboxes.forEach(checkbox => {
            checkbox.checked = this.checked;
          });
        });
      }

      function searchUsers() {
        const searchTerm = document.getElementById('searchUsers').value;
        const roleFilter = document.getElementById('roleFilter').value;
        const statusFilter = document.getElementById('statusFilter').value;
        
        // Search users (in real app, this would call backend)
        showAlert(`Searching for users with filters: "${searchTerm}", role: ${roleFilter}, status: ${statusFilter}`, 'info');
        loadUsers();
      }

      function editUser(userId) {
        showAlert(`Editing user ${userId}...`, 'info');
        // In real app, this would open edit modal
      }

      function viewUser(userId) {
        showAlert(`Viewing user ${userId} details...`, 'info');
        // In real app, this would open user details modal
      }

      function suspendUser(userId) {
        if (confirm('Are you sure you want to suspend this user?')) {
          showAlert(`User ${userId} suspended successfully!`, 'success');
        }
      }

      function deleteUser(userId) {
        if (confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
          showAlert(`User ${userId} deleted successfully!`, 'success');
        }
      }

      function approveUser(userId) {
        if (confirm('Are you sure you want to approve this user?')) {
          showAlert(`User ${userId} approved successfully!`, 'success');
        }
      }

      function rejectUser(userId) {
        if (confirm('Are you sure you want to reject this user?')) {
          showAlert(`User ${userId} rejected successfully!`, 'success');
        }
      }

      function showComingSoon(feature) {
        SupplyConnect.Utils.showAlert(`${feature} feature coming soon!`, 'info');
      }

      function logout() {
        if (confirm('Are you sure you want to logout from admin panel?')) {
          window.location.href = 'User/index.html';
        }
      }

      function showAlert(message, type) {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
        alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        alertDiv.innerHTML = `
          ${message}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        document.body.appendChild(alertDiv);

        // Auto-remove after 5 seconds
        setTimeout(() => {
          if (alertDiv.parentNode) {
            alertDiv.remove();
          }
        }, 5000);
      }
    </script>
  </body>
</html>
